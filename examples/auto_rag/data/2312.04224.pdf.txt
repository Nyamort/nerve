Parameter fine-tuning method for MMG model using real-scale ship
data
Rin Suyamaa,∗ , Rintaro Matsushitab , Ryo Kakutab , Kouki Wakitaa and Atsuo Makia,∗
a Department of Naval Architecture and Ocean Engineering, Graduate School of Engineering, Osaka University, 2-1 Yamadaoka, Suita, Osaka 565-0971,

arXiv:2312.04224v1 [eess.SY] 7 Dec 2023

Japan
b Monohakobi Technology Institute Co., Ltd., Yusen Building, 3-2 Marunouchi, 2-Chome, Chiyoda-ku, Tokyo 100-0005, Japan

ARTICLE INFO

ABSTRACT

Keywords:
Autonomous Vessel
System Identification
Fine-Tuning
Real-scale Ship Data
CMA-ES

In this paper, a fine-tuning method of the parameters in the MMG model for the real-scale ship is
proposed. In the proposed method, all of the arbitrarily indicated target parameters of the MMG model
are tuned simultaneously in the framework of SI using time series data of real-sale ship maneuvering
motion data to steadily improve the accuracy of the MMG model. Parameter tuning is formulated as
a minimization problem of the deviation of the maneuvering motion simulated with given parameters
and the real-scale ship trials, and the global solution is explored using CMA-ES. By constraining the
exploration ranges to the neighborhood of the previously determined parameter values, the proposed
method limits the output in a realistic range. The proposed method is applied to the tuning of 12
parameters for a container ship with five different widths of the exploration range. The results show
that, in all cases, the accuracy of the maneuvering simulation is improved by applying the tuned
parameters to the MMG model, and the validity of the proposed parameter fine-tuning method is
confirmed.

1. Introduction
The development of maneuvering models is essential to
the research and the development of autonomous navigation
algorithms. Autonomous navigation algorithms, studied intensively by institutions in many countries in recent years,
should be validated by maneuvering simulators. The reliability of the algorithm can be improved by testing it under
maneuvering simulators with accurate maneuvering models.
Research on modern maneuvering models has a long
history, with literature dating back to the 1940s, such as
Davidson and Schiff (1946). The maneuvering models have
been studied in terms of hydrodynamics by Motora (1959);
Inoue et al. (1981) and control engineering by Motora
(1955); Nomoto et al. (1957). In addition, researches have
been conducted on models of the hydrodynamic forces of individual components, such as hull, propeller, and rudder. For
instance, Abkowitz (1964); Åström and Källström (1976)
utilized Taylor expansion with respect to state variables to
derive a maneuvering model. The MMG model (Ogawa
and Kasai, 1978; Yasukawa and Yoshimura, 2015) was
groundbreaking in that it could represent each individual
component and their interaction. Fossen (2011) formulated
a maneuvering model in vector form inspired by mechanical
systems, and this formulation is often used in model-based
control design. In addition, there exist studies on models
expressed with polynomials of motion states and actuator
states (Miyauchi et al., 2023; Dong et al., 2023). In contrast
to these white box models, some studies have addressed the
∗ Corresponding author

Email addresses: suyama_rin@naoe.eng.osaka-u.ac.jp (R. Suyama);
rintaro_matsushita@monohakobi.com (R. Matsushita);
ryo_kakuta@monohakobi.com (R. Kakuta);
kouki_wakita@naoe.eng.osaka-u.ac.jp (K. Wakita);
maki@naoe.eng.osaka-u.ac.jp (A. Maki)

approximation of maneuvering models using black box models based on machine learning. Some examples of the black
box models are artificial neural networks (ANN) (Moreira
and Soares, 2003; Rajesh and Bhattacharyya, 2008; Zhang
and Zou, 2013; Oskin et al., 2013; Luo and Zhang, 2016;
Woo et al., 2018; He et al., 2022; Wakita et al., 2022; Wang
et al., 2023), support vector machine (Luo and Zou, 2009;
Wang et al., 2020), and Gaussian process (Ramirez et al.,
2018; Xue et al., 2020).
Among various maneuvering models, the MMG model
has high accuracy in simulations of maneuvering motion.
This is explained by the fact that it is formulated based on
detailed hydrodynamics. Due to its high performance, the
MMG model is widely used for the design and validation of
autonomous navigation algorithms. Li et al. (2013) validated
the path following control law based on sliding mode control
by numerical simulations following the MMG model. Zhang
et al. (2017) validated the course keeping control law with
nonlinear feedback in a simulation based on the MMG
model. Zheng et al. (2022) designed a path following control
of an unmanned surface vessel by applying the framework
of reinforcement learning with the state transition model
based on the MMG model. There are also examples of
simulations based on the MMG model that solve the autonomous berthing/unberthing problems in the framework
of off-line trajectory planning (Maki et al., 2020; Miyauchi
et al., 2022b; Suyama et al., 2022).
The MMG model contains constant parameters to be
identified. There have been various methods for the identification of parameters in the MMG model for model-scale
ships. Classically, captive tests were conducted to identify
the parameters (Ogawa and Kasai, 1978; Yasukawa and
Yoshimura, 2015). Computational fluid dynamics (CFD) is
also used for the identification of the parameters in the MMG

ORCID (s):

Suyama et al.: Preprint submitted to Elsevier

Page 1 of 13

Parameter fine-tuning method for MMG model using real-scale ship data

model (Zhang et al., 2019). Sakamoto et al. (2019) identified
the values of the parameters in the MMG model based on the
captive model tests simulated with CFD.
So far in most cases, the parameters for the real-scale
ship MMG model were identified based on the results of
model-scale captive tests. One of the differences between
the maneuvering motion of model-scale ships and real-scale
ships is the difference in Reynolds numbers. To correct the
effect of the difference in Reynolds numbers, for instance,
for limited parameters such as the frictional resistance coefficient for an equivalent flat plate and the wake coefficient
in straight moving, there are widely used methods such as
the three-dimensional extrapolation method (e.g. (Yasukawa
and Yoshimura, 2015)).
However, at this time, the methodology for the identification of the parameters in the real-scale ship MMG model
using captive tests is not established. Some parameters, such
as the flow straightening coefficient, are sometimes used
without correcting for the effect of the difference in Reynolds
numbers, although the effects have been noted (Aoki et al.,
2006). In addition, the effects of the difference in Reynolds
numbers are not completely clarified for all parameters in
the MMG model. If captive tests on real-scale ships were
conducted, the parameters could be identified without being
affected by the difference in Reynolds numbers, but captive
tests on large ships, such as containers, are not possible.
Another method for identification of the parameters in
the real-scale ship MMG model is a heuristic tuning of previously determined values by referring to the maneuvering
motion data of the real-scale ship. In most cases, this tuning
is implemented by experienced engineers using their own
heuristic methods based on their senses (Sutulo and Soares,
2014). This heuristic tuning directly refers to real-scale ship
maneuvering motion data, so the accuracy of the MMG
model with the tuned parameters can be steadily improved.
However, heuristic tuning of a large number of parameters
is not optimal, so an automatic tuning method needs to be
established.
System identification (SI) is applicable for the determination of the values of parameters in the real-scale ship
MMG model. SI is an identification framework for system
parameters using input/output data of the target system.
Therefore, SI for the parameters in the MMG model of
real-scale ships can be implemented only with time series
data of the maneuvering motion of the subject real-scale
ship. SI has been applied to parameter identification of ship
maneuvering models. Kalman filter is one of the popular
methods for SI, and Åström and Källström (1976); Abkowitz
(1980) applied Kalman filter to the Abkowitz model. A
combination of state estimation and SI was proposed by
(Yoon and Rhee, 2003) for parameter identification. Araki
et al. (2012) validated the SI method using the maneuvering
motion data simulated using CFD. Sutulo and Soares (2014)
adopted the genetic algorithm as the exploration method
for the optimal values of parameters in SI. This study was
extended to SI for the maneuvering model with a modular
structure (Sutulo and Soares, 2023). Miyauchi et al. (2022a)
Suyama et al.: Preprint submitted to Elsevier

proposed a parameter identification method for the MMG
model without the initial guess of the parameters using the
SI framework. This study was extended to the parameter
identification of the Abkowitz model with more than 200
parameters and validated its effectiveness (Miyauchi et al.,
2023). However, in the method proposed by Miyauchi et al.
(2022a, 2023), maneuvering motion data with random inputs, which is difficult to obtain in the operation of realscale ships, were used, and the validation of the method
was limited to model-scale ship cases. Several studies on
SI utilize time series data of real-scale ship maneuvering
motion (Abkowitz, 1980; Kim, 2018; Meng et al., 2022;
Kambara et al., 2022; Wang et al., 2023), but these studies
have focused on certain components of the maneuvering
model, linear maneuvering models, or ANN models. To the
best of the authors’ knowledge, the SI method for the whole
MMG model using real-scale ship data is not discussed.
In this study, the authors propose a fine-tuning method
for all of the arbitrarily indicated target parameters of the
MMG model using the framework of SI. The proposed
method is designed to automatically fine-tune the parameter values previously determined based on hydrodynamics,
captive model tests, and CFD to the ones for the real-scale
MMG model. The proposed method directly refers to the
time series data of real-scale ship maneuvering motion and
steadily improves the performance of the MMG model with
the tuned parameter in terms of the accuracy of the simulated
maneuvering motion. The parameter tuning is formulated
as a constrained minimization problem, and the solution is
explored using Covariance Matrix Adaption Evolutionary
Computation (CMA-ES) (Hansen, 2007; Hansen and Auger,
2014). To obtain realistic values for the MMG parameters,
the ranges of available values for the target parameters in the
fine-tuning problem are constrained to the neighborhood of
the previously determined values. The proposed parameter
fine-tuning method is applied to a container ship with 𝐿pp =
83m and validated. The objective of this study is not to clarify the effect of the difference in Reynolds numbers between
real-scale ships and model-scale ships, but to establish a
practical method for fine-tuning MMG parameters.
The rest of the manuscript is organized as follows. Sec.2
describes the notation used in this manuscript. The MMG
model of the subject ship of this study is detailed in Sec.3.
The proposed parameter fine-tuning method is described in
Sec.4. Sec.5 details the CMA-ES. Sec.6 shows the results of
parameter tuning for a container ship. The discussion on the
proposed method is presented in Sec.7. Sec.8 concludes this
manuscript.

2. Notation
ℝ represents the set of all real numbers. |𝑥| represents
the absolute value of 𝑥 ∈ ℝ. The overdot “ ̇ ” represents
the derivative with respect to time 𝑡. 𝐴⊤ represents the
transposed array of the array 𝐴.

Page 2 of 13

Parameter fine-tuning method for MMG model using real-scale ship data
Table 2
Explanation of symbols.
Vector
𝑝

𝜉
𝜏

Elements
𝑝1
𝑝2
𝜓
𝑢
𝑣m
𝑟
𝑛P
𝛿

Description
Position on the Earth-fixed frame.
Position on the Earth-fixed frame.
Heading angle.
Surge velocity.
Sway velocity at the midship.
Yaw angular velocity.
Propeller revolution number.
Rudder angle.

Fig. 1: Coordinate systems.

(𝑡), which indicates the dependence of variables on time, is
omitted to simplify the description.
States 𝑝 and 𝜉 follow the kinematics equation:

Table 1
Principal particulars of the subject ship.
Item
𝐿pp [m]
𝐵 [m]
𝑑 [m]
𝐶b
𝑥G [m]
𝐷P [m]
𝐻R [m]
𝐴R [m2 ]

𝑝̇ = 𝑅(𝑝)𝜉 ,

Value
83.0
13.5
3.8
0.737
0.93
2.80
3.49
6.282

where
⎛cos 𝜓
𝑅(𝑝) ∶= ⎜ sin 𝜓
⎜
⎝ 0

First, coordinate systems are defined as Fig. 1 shows.
O − 𝑥𝑦 in Fig. 1 represents a body-fixed coordinate system
with the origin fixed at the midship. The ship is assumed to
move on an Earth-fixed coordinate system OE −𝑥E 𝑦E . In this
study, the subject ship was a container ship M. V. SUZAKU.
The principal particulars of the subject ship are summarized
in Tab. 1. The maneuvering motion of the ship is represented
with state variables:
𝑝(𝑡) ∶= (𝑝1 (𝑡) 𝑝2 (𝑡) 𝜓(𝑡))⊤ ,

(1)

𝜉(𝑡) ∶= (𝑢(𝑡) 𝑣m (𝑡) 𝑟(𝑡))⊤ .

(2)

The augmented variable:
(3)

is defined. The control input is defined as
𝜏(𝑡) ∶= (𝑛P (𝑡) 𝛿(𝑡))⊤ .

(4)

The physical meaning of each component of these variables
is summarized in Tab. 2. Each component of these variables
follows the coordinate systems in Fig. 1. In this study, the
authors only consider forward motion with forward propeller
revolution; 𝑢(𝑡) > 0 and 𝑛P (𝑡) > 0. In addition, current and
wind are ignored as they are assumed to have little effect
on the maneuvering motion in this study. In the following,
Suyama et al.: Preprint submitted to Elsevier

− sin 𝜓
cos 𝜓
0

0⎞
0⎟ .
⎟
1⎠

(6)

The equation of motion of ship maneuvering is formulated
as

3. MMG model

𝜁 (𝑡) ∶= (𝑝(𝑡)⊤ 𝜉(𝑡)⊤ )⊤ ∈ ℝ6

(5)

⎧(𝑚 + 𝑚𝑥 )𝑢̇ − (𝑚 + 𝑚𝑦 )𝑣m 𝑟 − 𝑥G 𝑚𝑟2 = 𝑋
⎪
⎨ (𝑚 + 𝑚𝑦 )𝑣̇ m + (𝑚 + 𝑚𝑥 )𝑢𝑟 + 𝑥G 𝑚𝑟̇ = 𝑌
⎪
2
⎩ (𝐼g + 𝑥G 𝑚 + 𝐽𝑧𝑧 )𝑟̇ + 𝑥G 𝑚(𝑣̇ m + 𝑢𝑟) = 𝑁

(7)

where 𝑚, 𝑚𝑥 , 𝑚𝑦 , 𝐼g , 𝐽𝑧𝑧 , 𝑥G are the displacement, the added
mass for surge motion, the added mass for sway motion, the
moment of inertia for yaw motion along the vertical line
passing the midship, the added moment of inertia for yaw
motion, 𝑥 coordinate of the center of gravity of the ship,
respectively. 𝑋, 𝑌 , and 𝑁 in Eq. (7) represent the forces
and moments, excluding centrifugal forces, on the body fixed
coordinate system O − 𝑥𝑦. The MMG model (Yasukawa and
Yoshimura, 2015) represents 𝑋, 𝑌 , and 𝑁 as the sum of the
effects of the hull force, propeller force, and rudder force as
follows:
⎧ 𝑋(𝜃 t ) = 𝑋H + 𝑋P + 𝑋R
⎪
t
⎨ 𝑌 (𝜃 ) = 𝑌H + 𝑌P + 𝑌R
⎪𝑁(𝜃 t ) = 𝑁 + 𝑁 + 𝑁
⎩
H
P
R

(8)

where the argument 𝜃 t represents the target parameter to
be tuned. The target parameter 𝜃 t is detailed in Sec.4.1.
The MMG model’s representation of hull force, propeller
force, and rudder force is unique in that it even takes into
account the interference and interaction of each component,
as detailed below. By reshaping Eq. (7), the system for 𝜉 is
obtained as
𝜉̇ = 𝑓MMG (𝜉, 𝜏; 𝜃 t ) ,

(9)

Page 3 of 13

Parameter fine-tuning method for MMG model using real-scale ship data

3.2. Propeller force (Okuda et al., 2023)

where

The propeller force for 𝑢 > 0 and 𝑛P > 0 was modeled

t

𝑓MMG (𝜉, 𝜏; 𝜃 )
∶= 𝑀

⎛𝑋(𝜃 t ) + (𝑚 + 𝑚𝑦 )𝑣m 𝑟 + 𝑥G 𝑚𝑟2 ⎞ (10)
⎟ ,
𝑌 (𝜃 t ) − (𝑚 + 𝑚𝑥 )𝑢𝑟
⎜
⎟
t
𝑁(𝜃 ) − 𝑥G 𝑚𝑢𝑟
⎝
⎠

as

−1 ⎜

⎛𝑚 + 𝑚𝑥
𝑀 ∶= ⎜ 0
⎜
⎝ 0

0
𝑚 + 𝑚𝑦
𝑥G 𝑚

0
⎞
⎟ . (11)
𝑥G 𝑚
⎟
2
𝐼g + 𝑥G 𝑚 + 𝐽𝑧𝑧 ⎠

Augmenting Eq. (5) and Eq. (9), the system for 𝜁 is obtained
as
𝜁̇ = 𝑓𝜁 (𝜁 , 𝜏; 𝜃 t ) ,

(12)

where

(
)⊤
𝑓𝜁 (𝜁 , 𝜏; 𝜃 t ) ∶= (𝑅(𝑝)𝜉)⊤ (𝑓MMG (𝜉, 𝜏; 𝜃 t ))⊤
. (13)

The following sections detail the hydrodynamic force
model for each component. The MMG model used in this
study is based on the one proposed by Okuda et al. (2023).
However, the model for hull force was the widely used
polynomial model.
In this manuscript, characters with the prime symbol
represent nondimensionalized quantities. The nondimensionalized values of physical quantities with unit [m], [kg],
[kgm2 ], and [m∕s] are calculated by dividing with 𝐿pp ,
0.5𝜌𝐿2pp 𝑑, 0.5𝜌𝐿4pp 𝑑, and 𝑈 , respectively, where 𝑈 ∶=
√
𝑢2 + 𝑣2m is the ship speed. In the following, 𝛽 ∶=
arctan(−𝑣m ∕𝑢) represents the drift angle.

⎧ 𝑋P = 1 𝜌𝑆P 𝑉 2 (1 − 𝑡P )𝐾T (𝜙P )
𝑟
2
⎪
⎪
1
2
⎨ 𝑌P = 𝜌𝑆P 𝑉𝑟 𝐶P𝑌 (𝜙P )
2
⎪
⎪𝑁 = 1 𝜌𝑆 𝐿 𝑉 2 𝐶 (𝜙 ) .
⎩ P 2 P pp 𝑟 P𝑁 P

Here 𝑡P is a constant parameter called the thrust deduction
factor. 𝜙P is defined as
(
)
𝑢P
180
𝜙P ∶=
arctan
(17)
𝜋
0.7𝜋𝑛P 𝐷P
where 𝑢P ∶= (1 − 𝑤P )𝑢. The function 𝐾T (𝜙P ) was modeled
as
𝐾T (𝜙P ) =3.31 × 10−6 𝜙3P − 3.72 × 10−4 𝜙2P
− 2.60 × 10−3 𝜙P + 0.167 ,

⎧ ′ ′ ′
′
′ ′2
′ ′ ′
′ ′2
⎪ 𝑋H (𝑣m , 𝑟 ) = −𝑅0 + 𝑋𝑣𝑣 𝑣m + 𝑋𝑣𝑟 𝑣m 𝑟 + 𝑋𝑟𝑟 𝑟
′
′
′
′4
⎪
+ 𝑋𝑣𝑣𝑣𝑟
𝑣′3
m 𝑟 + 𝑋𝑣𝑣𝑣𝑣 𝑣m
⎪
⎪ 𝑌H′ (𝑣′m , 𝑟′ ) = 𝑌𝑣′ 𝑣′m + 𝑌𝑟′ 𝑟′
⎪
′
′
′2 ′
+ 𝑌𝑣𝑣𝑣
𝑣′3
⎪
m + 𝑌𝑣𝑣𝑟 𝑣m 𝑟
(15)
⎨
′ ′ ′2
′ ′3
+ 𝑌𝑣𝑟𝑟
𝑣m 𝑟 + 𝑌𝑟𝑟𝑟
𝑟
⎪
⎪𝑁 ′ (𝑣′ , 𝑟′ ) = 𝑁 ′ 𝑣′ + 𝑁 ′ 𝑟′
𝑣 m
𝑟
⎪ H m
′
′
′2 ′
⎪
+ 𝑁𝑣𝑣𝑣
𝑣′3
m + 𝑁𝑣𝑣𝑟 𝑣m 𝑟
⎪
′
′ ′3
⎪
+ 𝑁𝑣𝑟𝑟
𝑣′m 𝑟′2 + 𝑁𝑟𝑟𝑟
𝑟
⎩
where the coefficients are constant parameters which are
called the hydrodynamic derivatives.
Suyama et al.: Preprint submitted to Elsevier

(18)

by fitting measured data in the propeller open test shown in
Fig.6 in the original paper (Okuda et al., 2023). The function
𝐶P𝑌 (𝜙P ), 𝐶P𝑁 (𝜙P ) were modeled as
𝐶P𝑌 (𝜙P ) = − 2.83 × 10−5 𝜙2P + 6.04 × 10−4 𝜙P
− 1.28 × 10−2 ,
⎧ − 2.48 × 10−4 𝜙 − 1.70 × 10−3
P
⎪
for 𝜙P < 20 ,
⎪
𝐶P𝑁 (𝜙P ) = ⎨
−4
−3
⎪ − 1.86 × 10 𝜙P + 4.03 × 10
⎪
for 𝜙P ≥ 20 ,
⎩

3.1. Hull force (Okuda et al., 2023)
The surge force, the sway force, and the yaw moment
induced by the interaction between the ship hull and the fluid
were modeled as follows:
⎧ 𝑋H = 1 𝜌𝐿pp 𝑑𝑈 2 𝑋 ′ (𝑣′ , 𝑟′ )
H m
2
⎪
⎪
1
′
2 ′ ′
(14)
⎨ 𝑌H = 𝜌𝐿pp 𝑑𝑈 𝑌H (𝑣m , 𝑟 )
2
⎪
⎪𝑁 = 1 𝜌𝐿2 𝑑𝑈 2 𝑁 ′ (𝑣′ , 𝑟′ )
⎩ H 2 pp
H m
The nondimensionalized forces and moment were modeled
as

(16)

(19)

(20)

by fitting measured data shown in Fig.13 in the original
paper (Okuda et al., 2023). In addition,
𝑆P ∶=

𝜋𝐷P2
4

is the propeller disk area, and
√
𝑉𝑟 ∶= 𝑢2P + (0.7𝜋𝑛P 𝐷P )2

(21)

(22)

is the apparent inflow velocity into the propeller. Here the
wake fraction factor 𝑤P was modeled as
𝑤P = 𝑤P0 exp(𝐶𝑤 𝛽P2 )

(23)

𝛽P ∶= 𝛽 − 𝑙P′ 𝑟′

(24)

where

is the geometrical inflow angle of the propeller with 𝑙P′ =
−0.5, 𝑤P0 is the value of 𝑤P at 𝛽P = 0.

Page 4 of 13

Parameter fine-tuning method for MMG model using real-scale ship data

3.3. Rudder force (Okuda et al., 2023)
The surge force, sway force, and yaw moment induced
by the rudder were modeled as follows:
⎧ 𝑋R = −(1 − 𝑡R )𝐹N sin 𝛿
⎪
⎨ 𝑌R = −(1 + 𝑎H )𝐹N cos 𝛿
⎪𝑁 = −(𝑥 + 𝑎 𝑥 )𝐹 cos 𝛿
R
H H N
⎩ R

Table 3
Pre-determined values of the added masses and added moment
of inertia (Okuda et al., 2023).
Item
𝑚′𝑥
𝑚′𝑦
′
𝐽𝑧𝑧

(25)

Value
0.010
0.168
0.010

The rudder normal force 𝐹N was model as
1
𝜌𝐴 𝑈 2 {𝑓 (𝛿 ) sin 𝛼R + 𝐶l0 (𝛿f )}
2 R R 𝛼 f
where 𝐴R is the rudder area,
√
𝑈R ∶= 𝑢2R + 𝑣2R
𝐹N =

(26)

(27)

is the resultant inflow velocity of the rudder, and
𝛼R ∶= 𝛿 − 𝚊𝚝𝚊𝚗𝟸(𝑣R , 𝑢R )

(28)

is the effective inflow angle of the rudder. The longitudinal
inflow velocity component of the rudder 𝑢R was modeled as
𝑢R = max{𝑢∗R , 𝑢∗∗
R }

(29)

where

Table 4
Pre-determined values of the parameters in the model of 𝑋H ,
𝑌H , and 𝑁H (Okuda et al., 2023).
Item
𝑅′0
′
𝑋𝑣𝑣
′
𝑋𝑣𝑟 + 𝑚′𝑦
𝑋𝑟𝑟′
′
𝑋𝑣𝑣𝑣𝑟
′
𝑋𝑣𝑣𝑣𝑣

Value
0.017
0.009
0.160
−0.0164
−0.824
−0.114

is the ratio of the diameter of the propeller to the rudder
height. The lateral inflow velocity component of the rudder
𝑣R was modeled as
𝑣R = 𝛾R (𝑈 sin 𝛽 − 𝑙R 𝑟)

(32)

where 𝑙R is an experimental constant, and 𝛾R is a constant
determined based on
{
𝛾Rp for 𝛽R > 0
𝛾R =
(33)
𝛾Rn for 𝛽R < 0
with effective inflow angle
𝛽R ∶= 𝛽 − 𝑙R′ 𝑟′ .

(34)

𝑓𝛼 (⋅) and 𝐶l0 (⋅) in Eq. (26) was modeled as functions of the
flap angle 𝛿f with
𝑓𝛼 (𝛿f ) = 𝑓𝛼0 + 𝑓𝛼2 𝛿f2

(35)

𝐶l0 (𝛿f ) = 𝐶l01 𝛿f + 𝐶l03 𝛿f3

(36)

Value
−0.329
0.090
−0.787
−0.022
−0.206
0.001

Item
𝑁𝑣′
𝑁𝑟′
′
𝑁𝑣𝑣𝑣
′
𝑁𝑣𝑣𝑟
′
𝑁𝑣𝑟𝑟
′
𝑁𝑟𝑟𝑟

Value
−0.106
−0.057
−0.037
−0.105
0.012
−0.008

Table 5
Pre-determined values of the parameters in the model of 𝑋P ,
𝑌P , and 𝑁P (Okuda et al., 2023).

{
(√
)
}
⎧ ∗
8𝐾T (𝜙P )
1+
−1 +1 ,
⎪ 𝑢R = 𝑢P 𝜖 𝜂R 𝜅
(30)
𝜋𝐽P2
⎨
⎪ ∗∗
⎩𝑢R = 0.7𝜋𝑛P 𝐷P 𝑢R0 .

Here, 𝜖 is the ratio of the wake fraction factors at the propeller and rudder positions, 𝜅 is an experimental constant,
and
𝐷
𝜂R ∶= P
(31)
𝐻R

Item
𝑌𝑣′
𝑌𝑟′ − 𝑚′𝑥
′
𝑌𝑣𝑣𝑣
′
𝑌𝑣𝑣𝑟
′
𝑌𝑣𝑟𝑟
′
𝑌𝑟𝑟𝑟

Item
𝑡P
𝑤P0
𝐶𝑤

Value
0.080
0.422
−2.0

Table 6
Pre-determined values of the parameters in the model of 𝑋R ,
𝑌R , and 𝑁R (Okuda et al., 2023).
Item
𝑡R
𝑎H
𝑥′H
𝜖
𝜅
𝑢R0
𝑙R′

Value
−0.058
0.158
−0.605
1.27
0.5
0.14
−0.888

Item
𝛾Rp
𝛾Rn
𝑓𝛼0
𝑓𝛼2
𝐶l01
𝐶l03

Value
0.483
0.172
2.411
−0.381
1.164
−0.381

3.4. Pre-determined parameter values
The parameters included in the MMG model described
in the previous sections have values determined based on
hydrodynamics, captive model tests, and CFD, without using
the time series of real-scale ship trials. In this manuscript,
these values are referred to as pre-determined values. The
pre-determined values of the parameters used in this study
are those given in the original paper (Okuda et al., 2023).
The pre-determined values of added masses and added
moment of inertia are shown in Tab. 3. Moreover, the predetermined values of the parameters used in the models of
hydrodynamic forces and moments are shown in Tabs. 4 to 6.

where 𝑓𝛼0 , 𝑓𝛼2 , 𝐶l01 , and 𝐶l03 are constants.
The flap angle 𝛿f is determined depending upon the
rudder angle 𝛿 in the manipulation system of the subject
ship. The relationship between 𝛿 and 𝛿f is shown in Fig.5
in the original paper (Okuda et al., 2023).
Suyama et al.: Preprint submitted to Elsevier

Page 5 of 13

Parameter fine-tuning method for MMG model using real-scale ship data

4.3. Real-scale ship trials data

4. Parameter tuning method
In this section, the target parameter to be tuned, the
exploration range for the target parameter, the real-scale ship
trials used in this study, and the mathematical formulation of
the parameter tuning problem are described.

In this study, the time series of real-scale ship trials were
utilized. One time series was treated as matrix 𝐷 ∈ ℝ8×𝑇
with
⊤

In this study, among the parameters included in the
MMG model shown in Sec.3, the following 12 parameters
were set as the target parameter 𝜃 t to be tuned.
𝜃 t ∶= (𝑅′0 𝑡P 𝑤P0 𝐶𝑤 𝑡R 𝑎H 𝑥′H 𝜖 𝜅 𝑙R′ 𝛾Rp 𝛾Rn )⊤ (37)
The target parameters were limited to the ones that have a
big influence on the simulated forces and moment. However,
the hydrodynamic derivatives were excluded from the target
for the simplification of the problem. On the other hand, 𝑅′0
was included in the target of the tuning without applying the
extrapolation method. The objective for this is to obtain an
average value of 𝑅′0 concerning the variation of ship speed
due to maneuvering motion.
The applicability of the proposed method is not limited
to the case with the target parameter Eq. (37). The target
parameter can be selected arbitrarily by the users.

4.2. Exploration range
In the parameter tuning, the exploration ranges for all
elements of 𝜃 t were limited. In this study, it is assumed
that all of the parameters in the MMG model of the modelscale ship of the subject ship have their values which have
been determined based on hydrodynamics, captive model
tests, and CFD. The exploration ranges were set to be the
neighborhood of those values. By constraining the ranges of
available values for the target parameters in the fine-tuning
problem to the neighborhood of the pre-determined values,
the proposed method limits the output in realistic ranges.
In the following, the candidate value and the predetermined value of the target parameter 𝜃 t ∈ ℝ12 are
described as 𝜃̂ ∈ ℝ12 and 𝜃 pre ∈ ℝ12 , respectively. The
exploration range for the element of 𝜃̂𝑖 (𝑖 = 1, ⋯ , 12) was
formulated as

12
∏

(40)

𝑇 is the number of time steps included in the time series
data with the time step size: Δ𝑡 = 1.0 s. Elements 𝑝𝑖 , 𝜉 𝑖 ,
and 𝜏 𝑖 represent 𝑝, 𝜉, and 𝜏 at the time step 𝑖, respectively.
In this study, eight turning tests of the subject ship with
𝛿 = ±10, ± 20, ± 35, ± 40 deg. were prepared and are
described as 𝐷±10 , 𝐷±20 , 𝐷±35 , 𝐷±40 , respectively. Fig. 2
exemplifies 𝐷+10 .
These time series data were utilized both for the parameter tuning and the test of the tuned parameter. In the
parameter tuning phase, the parameter that minimizes the
deviation between numerically simulated time series and
the real-scale ship data was explored. In the test phase, the
tuned parameter was applied to the simulation of real-scale
ship data which was not utilized in the tuning phase and
evaluated. The sets of time series data for the parameter
tuning and the performance test are defined as
tune ∶= {𝐷+10 , 𝐷−20 , 𝐷+35 , 𝐷−40 }

(41)

test ∶= {𝐷−10 , 𝐷+20 , 𝐷−35 , 𝐷+40 } ,

(42)

and

respectively.

4.4. Problem formulation
In this study, the performance of the maneuvering model
̂ was defined based on the
with the given parameter 𝜃̂ ∈ Θ
comparison of the simulated time series of maneuvering
motion and the real-scale ship trial data. Here, the deviation
of the simulated time series following Eq. (12) with the
MMG model and the time series of real-scale ship trial
was computed, and the candidate parameter 𝜃̂ which minimizes this deviation was output as the optimal value in
the parameter tuning problem. This minimization problem
is summarized as follows.

(38)

with 𝑎r > 0. The present study considered the hydrodynamics underlying the maneuvering motion to some extent
by defining the exploration range with reference to the predetermined values. Further investigation of the exploration
range for parameters based on the theoretical background is
one of the issues for future research. The exploration range
of 𝜃 t ∈ ℝ12 is described as
̂ ∶=
Θ

⊤

𝑖 = 1, ⋯ , 𝑇 .

4.1. Target parameter

̂ 𝑖 ∶= [ 𝜃 pre − 𝑎r |𝜃 pre |, 𝜃 pre + 𝑎r |𝜃 pre | ]
Θ
𝑖
𝑖
𝑖
𝑖

⊤

( 𝐷1𝑖 ⋯ 𝐷8𝑖 )⊤ ∶=( 𝑝𝑖 𝜉 𝑖 𝜏 𝑖 )⊤ ,

̂ tune ) ∶=
minimize 𝐽 (𝜃;
̂
̂ Θ
𝜃∈

𝑇
∑ ∑

𝑝̃𝑖⊤ 𝑄𝑝̃𝑖

𝐷∈tune 𝑖=2

⎧ 𝑝̃ ∶= 𝑝̂ − 𝑝
⎪ 𝑖
𝑖 𝑖 𝑖 ⊤
⎪ 𝑝̂ ∶= (𝜁̂1 𝜁̂2 𝜁̂3 )
s.t. ⎨ 𝑖
𝑖−1
𝑖−1 𝑖−1 ̂
⎪ 𝜁̂ = 𝜁̂ + 𝑓𝜁 (𝜁̂ , 𝜏 ; 𝜃)Δ𝑡
⎪ ̂1
1
⎩𝜁 = 𝜁
𝑖

𝑖

𝑖

(43)

for 𝑖 = 2, ⋯ , 𝑇
̂𝑖 .
Θ

(39)

𝑖=1

Five cases of parameter fine-tuning with 𝑎r
=
0.2, 0.3, 0.4, 0.5, 0.6 were conducted for the subject
ship.
Suyama et al.: Preprint submitted to Elsevier

Here 𝑄 ∈ ℝ3×3 is a weight matrix for deviation 𝑝.
̃
The solution of the minimization problem Eq. (43) was
explored using CMA-ES. This exploration algorithm is detailed in Sec.5. In the following, the output of CMA-ES for
the problem Eq. (43) is described as 𝜃 ∗ .
Page 6 of 13

3
2

600

200

250

500

100
0

750

0

250

0

250

500

750

500

750

50

0.0
0.5

0

0

250

500

750

0
50

t [s]
0

250

500

750

y E [m]

r [deg. /s]

200

0

δ [deg. ]

vm [m/s]

x E [m]

400

nP [rpm]

u [m/s]

Parameter fine-tuning method for MMG model using real-scale ship data

0.4
0.2
0

250

500

750

t [s]
Fig. 2: An example of time series data of real-scale ship trial prepared in this study: turning test with 𝛿 = 10 deg..

5. Covariance Matrix Adaption Evolutionary
Computation (CMA-ES)
CMA-ES (Hansen, 2007; Hansen and Auger, 2014) is
a numerical solver for optimization problems and is known
to have high efficiency in the exploration of the optimal
solution. In the field of ship navigation, CMA-ES has been
applied, for instance, to the optimal control problem for
autonomous berthing (Maki et al., 2020) and the parameter exploration problem for the MMG model based on SI
(Miyauchi et al., 2022a). In general, evolutionary computation does not need the gradient of the objective function.
Therefore, users do not have to consider the differentiability
of the designed objective function. Although the minimization problem treated in this study includes the computation
of maneuvering motion based on the nonlinear and uncontinuous MMG model, the exploration of the optimal solution
with CMA-ES is not inappropriate, as the problem is similar
to the one in the paper by Miyauchi et al. (2022a) where
CMA-ES succeeded in the exploration. In the implementation of CMA-ES in this study, the box constraint was handled
based on the method proposed by Sakamoto and Akimoto
(2017).
The algorithm of CMA-ES is summarized as follows.
The values of the objective function for candidate solutions
which are generated following the normal distribution defined with a given mean and a given covariance matrix are
iteratively calculated. At each step, the algorithm updates the
mean and the covariance matrix of the distribution based on
the values of the objective function. This iterative update is
continued until the convergence of the distribution, and the
resultant value of the mean is output as the optimal solution.

Suyama et al.: Preprint submitted to Elsevier

In this research, CMA-ES with the restart strategy (Auger
and Hansen, 2005) was applied.

6. Results
6.1. Verification of MMG model with
pre-determined parameters
For the verification of the MMG model, the simulation
of maneuvering motion was conducted with pre-determined
parameters shown in Tabs. 3 to 6. This simulation was
calculated by applying Euler method to Eq. (12) with time
step size: Δ𝑡 = 1.0 s. The initial state was 𝑝(0) = (0 0 0)⊤ ,
𝑢(0) = 6 knots = 3.086 m∕s, 𝑣m (0) = 𝑟(0) = 0. The control
input was fixed as 𝑛P = 106 rpm, 𝛿 = ±35 deg.. These
conditions were equivalent to the ones set in the simulation
shown in Fig.17 (Section 5.3.1) in the original paper (Okuda
et al., 2023). The simulated time series is shown in Fig. 3.
Fig. 3 shows that the simulated turning motion matches the
one shown in the original paper (Okuda et al., 2023) in that
the diameter of the right turning circle is larger than that of
the left turning circle. This result verifies the MMG model
set in this study.

6.2. Parameter tuning
The weight matrix was set as 𝑄
=
diag(𝐿pp , 𝐿pp , 0.25𝜋). The initial population size was
set 𝜆 = 12, and the population size was doubled at the
restart of exploration with the upper limit 𝜆 ≤ 𝜆̄ = 128.
First, the process of the exploration by CMA-ES is
explained. The case of exploration with 𝑎r = 0.2 is shown
in Fig. 4. The horizontal axis of Fig. 4 shows the number
of iterations, The vertical axis of the upper figure of Fig. 4
shows the smallest value of the objective function calculated
Page 7 of 13

Parameter fine-tuning method for MMG model using real-scale ship data

250
1200
1000

J(θ ∗ ; D tune )

x E [m]

200
150

800
600

100

400

50

200

0

0

50
200

100

0

100

200

0.2

0.3

0.4
ar

0.5

0.6

Fig. 5: Values of the objective function on the tuned parameter
for tuning data tune .

y E [m]
Fig. 3: The trajectory of turning motion simulated based on
the MMG model with pre-determined values (𝛿 = ±35 deg.).

J(θ ∗ ; D test )

2000

J

15000

1500

10000

1000

5000

500
0

1000

2000

3000

4000

5000

log 10 (J − Jmin )

0

0.2

0.3

0

0.4
ar

0.5

0.6

5

Fig. 6: Values of the objective function on the tuned parameter
for test data test .

10
0

1000

2000

3000

Iteration

4000

5000

Fig. 4: Exploring process of CMA-ES (𝑎r = 0.2).

for each of the candidate solutions at the iteration. The
vertical axis of the lower figure of Fig. 4 shows the value
plotted in the upper figure minus the smallest value of the
objective function recorded in all iterations. The iteration at
which the value of 𝐽 increases abruptly represents the timing
when the convergence of the distribution is confirmed and
the exploration restarts with randomly initialized candidate
solutions. From Fig. 4, it can be confirmed that the value of
𝐽 has repeatedly converged to the same value. Not only in
the case of 𝑎r = 0.2, but also in all the cases conducted in
this study, it was confirmed that the optimal solution was
explored with a process similar to Fig. 4. Since multiple
restarts were observed in a single trial of the algorithm, and
convergence to the same value was observed at each restart,
the exploration algorithm for each case was run only once in
this study.
Second, the performance of the tuned parameter is
shown. For each 𝜃 ∗ explored in each 𝑎r , the values of the
objective function 𝐽 (⋅) were computed for the data set tune
and test . These values are shown in Figs. 5 and 6. It
can be confirmed that the value of 𝐽 (𝜃 ∗ ; tune ) decreases
Suyama et al.: Preprint submitted to Elsevier

as the value of 𝑎r increases. This means that the accuracy
of the simulated maneuvering motion for the tuning data
was improved by expanding the exploration range of the
target parameter. The value of 𝐽 (𝜃 ∗ ; test ) has the minimum
and the maximum at 𝑎r = 0.5 and 𝑎r = 0.6, respectively.
In the range from 𝑎r = 0.2 to 𝑎r = 0.5, the wider the
exploration range, the more accurate the MMG model with
the tuned parameter applied. However, in the case 𝑎r = 0.6,
while showing the best accuracy for tuning data, the value
of 𝐽 (𝜃 ∗ ; test ) is larger than the other cases. In the case 𝑎r =
0.6, it is considered that the exploration of the parameter that
can simulate the maneuvering motion more consistent with
the tuning data was performed by expanding the exploration
range, resulting in overfitting biased toward the tuning data.
The output values of the target parameters in the exploration with 𝑎r = 0.2 ∼ 0.6 are shown in Tab. 7. In addition,
the distribution of each element of the output parameter
in its exploration range is shown in Fig. 7. In Fig. 7, the
̂ 𝑖 is offset to [−1, 1], and the values of
exploration range Θ
each parameter are also offset. From Fig. 7, it is observed
that, in all cases, 𝑤P0 , 𝐶𝑤 , 𝑡R , 𝑎H , 𝑙R′ and 𝛾Rn converged to
boundary values on the same side of the exploration range,
respectively.
Finally, the time series data of the four real-scale ship trials included in test were compared with the time series simulated based on the MMG model with the pre-determined
and tuned parameter. The comparisons are shown in Figs. 8
Page 8 of 13

Parameter fine-tuning method for MMG model using real-scale ship data
Table 7
Explored values of target parameters.
𝑎r
0.2
0.3
0.4
0.5
0.6

𝑅′0
0.0174
0.0179
0.0188
0.0207
0.0204

𝑡P
0.0960
0.1040
0.1019
0.0400
0.0320

𝑤P0
0.5064
0.5486
0.5908
0.6330
0.6752

𝐶𝑤
−2.4000
−2.6000
−2.8000
−3.0000
−3.2000

𝑡R
−0.0464
−0.0406
−0.0348
−0.0290
−0.0232

𝑎H
0.1896
0.2054
0.2212
0.2370
0.2528

𝑥′H
−0.7260
−0.7865
−0.8470
−0.9075
−0.9680

𝜖
1.0438
1.0248
1.0049
1.1872
1.3736

𝜅
0.6000
0.6500
0.7000
0.4014
0.2000

𝑙R′
−1.0656
−1.1544
−1.2432
−1.3320
−1.4208

𝛾Rp
0.4866
0.4531
0.4262
0.3655
0.3017

𝛾Rn
0.2064
0.2236
0.2408
0.2580
0.2752

Explored value (offset)

1.0
0.5
Limit of exploring range (offset)
Tuned with ar = 0.2
Tuned with ar = 0.3
Tuned with ar = 0.4
Tuned with ar = 0.5
Tuned with ar = 0.6

0.0
0.5
1.0

R 0 0 tP wP0 Cw tR aH x 0 H ²

Target parameter

l 0 R γRp γRn

Fig. 7: Distribution of the explored values of target parameters in their exploration ranges.

to 11, respectively. All of the real-scale ship trials shown in
Figs. 8 to 11 were not used in the parameter tuning phase.
By comparing these with the simulated time series using
the MMG model with the tuned parameters, the estimation
performance of the tuned parameter on the real-scale ship
maneuvering motion can be evaluated. From trajectories
in the left figure of each of Figs. 8 to 11, in all cases of
𝑎r = 0.2 ∼ 0.6, the MMG models with the tuned parameter
simulate time series closer to the maneuvering motion of the
real-scale ship than the one with the pre-determined values.
Comparing the best-performing case 𝑎r = 0.5 (blue-colored)
and the worst-performing case 𝑎r = 0.6 (coral pink-colored),
although the turning circle diameter differs by about 1.5𝐿pp
for 𝐷−10 , not much difference in simulated maneuvering
motion is observed for 𝐷+20 , 𝐷−35 , and 𝐷+40 .

7. Discussion
From Figs. 8 to 11, it is confirmed that the parameters
were tuned to simulate the turning motions with larger
diameters than pre-determined parameters in all cases. Here,
Fig. 7 shows that 𝑎H > 0 is tuned to be large and 𝑥′H < 0
is tuned to be small in all cases, suggesting that 𝑁R is
computed to be large. On the other hand, 𝑤P0 and 𝑡R were
tuned to be large so that the propeller inflow velocity 𝑢P
and the fraction of rudder (1 − 𝑡R )𝐹N sin 𝛿 are computed to
be small, respectively. It is analyzed that these effects are

Suyama et al.: Preprint submitted to Elsevier

dominant compared to the effect of largely estimated rudder
moment 𝑁R .
Among the parameter tunings conducted in this study,
the parameter with the best performance on the test data was
obtained with the exploration range defined by 𝑎r = 0.5.
However, the proposed tuning method depends on the time
series data set of the real-scale ship trial used for fine-tuning.
When tuning the parameters of a maneuvering model, unexpected problems such as overfitting may occur depending on
the time series data used for tuning, the target parameters to
be tuned, and the exploration range of each parameter, as
observed in Fig. 6. Therefore, for parameters explored under
different conditions, it is not possible to determine which
output is the best for the simulation of the real-scale ship
maneuvering motion without at least checking the accuracy
of simulated maneuvering motion for time series data other
than tune , such as test in this study. Thus, if there is a
sufficient amount of time series data available for parameter
tuning, it is desirable to prepare test data separately from the
tuning data and compare the performance against validation
data to determine the best parameter.
However, the amount of available time series data of
real-scale ship maneuvering motion is limited. Therefore,
there may be cases where it is not possible to prepare
validation data. In such cases, parameters tuned in a certain condition would have to be used in practice without
performance validation. In this case, one should be careful

Page 9 of 13

Parameter fine-tuning method for MMG model using real-scale ship data

nP [rpm]

3

u [m/s]

Model-scale parameter
Tuned with ar = 0.2
Tuned with ar = 0.3
Tuned with ar = 0.4
Tuned with ar = 0.5
Tuned with ar = 0.6
Real-scale ship trial

2

50
0

0

200

400

600

400

0

200

0

200

400

600

400

600

50

200
0

25

0.6

δ [deg. ]

vm [m/s]

x E [m]

100

0.4

0
25

0.2
0

200

200

400

600

50

t [s]
600

400

200

0

y E [m]
r [deg. /s]

0.2
0.4
0.6
0

200

400

600

t [s]
Fig. 8: Comparison of seven time series data of turning test (𝛿 = −10 deg.) which is not utilized in parameter tuning: real-scale ship
trial 𝐷−10 , simulation by the MMG model with untuned parameters, and simulation by the MMG model with tuned parameters
(𝑎r = 0.2 ∼ 0.6).

not to set an unnecessarily wide exploration range, since
parameters may be explored biased toward the tuning data.

8. Concluding remarks
An automatic fine-tuning method for all of the arbitrarily indicated target parameters of the MMG model was
proposed. The proposed method tunes the parameter values
which are previously determined based on the hydrodynamics, captive model tests, and CFD to the ones for the MMG
model of the real-scale ship using the framework of SI.
The previously determined parameter values are utilized to
constrain the tuned parameter values to the realistic ranges.
By directly referring to the time series data of real-scale
ship maneuvering motion, the proposed method can steadily
improve the performance of the MMG model with the
tuned parameter in terms of the accuracy of the simulated
maneuvering motion. The proposed fine-tuning method was
applied to a container ship and validated with 12 target
parameters which is highly influential in the MMG model.
In all cases of parameter fine-tuning conducted with different
widths of exploration range, better parameters were obtained
compared to untuned parameters in terms of the accuracy of
the simulated real-scale trajectories.
Suyama et al.: Preprint submitted to Elsevier

CRediT authorship contribution statement
Rin Suyama: Conceptualization, Formal analysis,
Methodology, Software, Visualization, Writing - Original
Draft . Rintaro Matsushita: Data Curation, Project administration, Writing - Review & Editing . Ryo Kakuta:
Data Curation, Project administration, Writing - Review &
Editing . Kouki Wakita: Methodology, Writing - Review
& Editing . Atsuo Maki: Funding acquisition, Project
administration, Supervision, Writing - Review & Editing .

Acknowledgment
This study was conducted as a part of the Nippon
Foundation to Support Fully Autonomous Ship Development Project “MEGURI2040”. The authors are thankful
to Mr. Takuya Taniguchi (Osaka University) for a helpful
discussion. Moreover, this study was supported by a Grantin-Aid for Scientific Research from the Japan Society for
Promotion of Science (JSPS KAKENHI Grant #22H01701)
and by the Fundamental Research Developing Association
for Shipbuilding and Offshore (REDAS23-5(18A)).

Page 10 of 13

2

0

200

0.6

0
200

0

200

400

0
25

0.8

0

200

25

0.4

0

0
50

δ [deg. ]

vm [m/s]

100

50

400

0.2

200

100

0

1

300

x E [m]

nP [rpm]

Model-scale parameter
Tuned with ar = 0.2
Tuned with ar = 0.3
Tuned with ar = 0.4
Tuned with ar = 0.5
Tuned with ar = 0.6
Real-scale ship trial

u [m/s]

Parameter fine-tuning method for MMG model using real-scale ship data

200

400

50

400

t [s]

400

0.8

r [deg. /s]

y E [m]

0.6
0.4
0

200

400

t [s]
Fig. 9: Comparison of seven time series data of turning test (𝛿 = +20 deg.) which is not utilized in parameter tuning: real-scale ship
trial 𝐷+20 , simulation by the MMG model with untuned parameters, and simulation by the MMG model with tuned parameters
(𝑎r = 0.2 ∼ 0.6).

References
Abkowitz, M.A., 1964. Ship hydrodynamics - steering and manoeuvrability.
Technical Report. Hydro- and Aerodynamics Laboratory.
URL: https://repository.tudelft.nl/islandora/object/uuid:
d511bd6b-ca2e-4f10-ad9f-6c881eb1e9f8?collection=research.
Abkowitz, M.A., 1980. Measurement of hydrodynamic characteristics
from ship maneuvering trials by system identification. Transactions of
Society of Naval Architects and Marine Engineers 88, 283–318. URL:
https://trid.trb.org/view/157366.
Aoki, I., Kijima, K., Furukawa, Y., Nakiri, Y., 2006. On the prediction
method for maneuverability of a full scale ship. Journal of the Japan
Society of Naval Architects and Ocean Engineers 3, 157–165. doi:10.
2534/JJASNAOE.3.157. (in Japanese).
Araki, M., Sadat-Hosseini, H., Sanada, Y., Tanimoto, K., Umeda, N., Stern,
F., 2012. Estimating maneuvering coefficients using system identification methods with experimental, system-based, and cfd free-running
trial data. Ocean Engineering 51, 63–84. doi:10.1016/j.oceaneng.2012.
05.001.
Auger, A., Hansen, N., 2005. A restart cma evolution strategy with
increasing population size, in: 2005 IEEE Congress on Evolutionary
Computation, IEEE. pp. 1769–1776. doi:10.1109/CEC.2005.1554902.
Davidson, K.S., Schiff, L., 1946. Turning and course keeping qualities of
ships. Transactions SNAME .
Dong, Q., Wang, N., Song, J., Hao, L., Liu, S., Han, B., Qu, K., 2023. Mathdata integrated prediction model for ship maneuvering motion. Ocean
Engineering 285, 115255. doi:10.1016/J.OCEANENG.2023.115255.
Fossen, T.I., 2011. Handbook of Marine Craft Hydrodynamics and Motion
Control. John Wiley and Sons. doi:10.1002/9781119994138.

Suyama et al.: Preprint submitted to Elsevier

Hansen, N., 2007. The CMA Evolution Strategy: A Comparing Review, in:
Towards a New Evolutionary Computation. Springer Berlin Heidelberg,
pp. 75–102. doi:10.1007/3-540-32494-1_4.
Hansen, N., Auger, A., 2014. Principled design of continuous stochastic
search: From theory to practice, in: Principles of System Identification.
Springer, pp. 145–180. doi:10.1007/978-3-642-33206-7__8.
He, H.W., Wang, Z.H., Zou, Z.J., Liu, Y., 2022. Nonparametric modeling of
ship maneuvering motion based on self-designed fully connected neural
network. Ocean Engineering 251, 111113. doi:10.1016/J.OCEANENG.
2022.111113.
Inoue, S., Hirano, M., Kijima, K., 1981. Hydrodynamic derivatives on
ship manoeuvring. International Shipbuilding Progress 28, 112–125.
doi:10.3233/ISP-1981-2832103.
Kambara, T., Miyauchi, Y., Hosogaya, K., Maki, A., 2022. Fundamental study on estimation of system model for berthing and unberthing of full scale ship, in: Conference proceedings, the Japan
Society of Naval Architects and Ocean Engineers, pp. 2022A–
OS1–5. URL: https://www.jstage.jst.go.jp/article/conf/35/0/35_29/
_article/-char/en. (in Japanese).
Kim, D., 2018. Estimation of hydrodynamic coefficients from results of
real ship sea trials. Polish Maritime Research 25, 65–72. doi:10.2478/
pomr-2018-0133.
Li, R., Li, T., Bu, R., Zheng, Q., Chen, C.L., 2013. Active disturbance
rejection with sliding mode control based course and path following
for underactuated ships. Mathematical Problems in Engineering 2013.
doi:10.1155/2013/743716.
Luo, W., Zhang, Z., 2016. Modeling of ship maneuvering motion using
neural networks. Journal of Marine Science and Application 15, 426–
432. doi:10.1007/S11804-016-1380-8/METRICS.

Page 11 of 13

Parameter fine-tuning method for MMG model using real-scale ship data

nP [rpm]

3

u [m/s]

Model-scale parameter
Tuned with ar = 0.2
Tuned with ar = 0.3
Tuned with ar = 0.4
Tuned with ar = 0.5
Tuned with ar = 0.6
Real-scale ship trial

2
1

50
0

0

250

100

200

300

200

0

100

0

100

200

300

200

300

50

100
50

1.0

δ [deg. ]

vm [m/s]

150

x E [m]

100

0.5

0

0

100

200

300

25
0
25
50

t [s]

50
100

0

y E [m]

0.6

r [deg. /s]

200

0.8
1.0
1.2

0

100

200

300

t [s]
Fig. 10: Comparison of seven time series data of turning test (𝛿 = −35 deg.) which is not utilized in parameter tuning: real-scale
ship trial 𝐷−35 , simulation by the MMG model with untuned parameters, and simulation by the MMG model with tuned parameters
(𝑎r = 0.2 ∼ 0.6).

Luo, W.L., Zou, Z., 2009. Parametric identification of ship maneuvering
models by using support vector machines. Journal of Ship Research
53, 19–30.
URL: https://onepetro.org/JSR/article-abstract/
53/01/19/175116/Parametric-Identification-of-Ship-Maneuvering?
redirectedFrom=fulltext.

Maki, A., Sakamoto, N., Akimoto, ?.Y., Nishikawa, ?.H., Umeda, N.,
2020. Application of optimal control theory based on the evolution
strategy (cma-es) to automatic berthing. Journal of Marine Science and
Technology 25, 221–233. doi:10.1007/s00773-019-00642-3.
Meng, Y., Zhang, X., Zhu, J., 2022. Parameter identification of ship motion
mathematical model based on full-scale trial data. International Journal
of Naval Architecture and Ocean Engineering 14, 100437. doi:10.1016/
j.ijnaoe.2022.100437.
Miyauchi, Y., Akimoto, Y., Umeda, N., Maki, A., 2023. Development
of a mathematical model for harbor-maneuvers to realize modeling
automation. arXiv:2302.10459.
Miyauchi, Y., Maki, A., Umeda, N., Rachman, D.M., Akimoto, Y., 2022a.
System parameter exploration of ship maneuvering model for automatic
docking / berthing using cma-es. Journal of Marine Science and
Technology 27, 1065–1083.
Miyauchi, Y., Sawada, R., Akimoto, Y., Umeda, N., Maki, A., 2022b. Optimization on planning of trajectory and control of autonomous berthing
and unberthing for the realistic port geometry. Ocean Engineering 245,
110390. doi:10.1016/j.oceaneng.2021.110390.
Moreira, L., Soares, C.G., 2003. Dynamic model of manoeuvrability
using recursive neural networks. Ocean Engineering 30, 1669–1697.
doi:10.1016/S0029-8018(02)00147-6.
Motora, S., 1955. Course stability of ships. Journal of Zosen Kiokai
77, 69–90. URL: https://www.jstage.jst.go.jp/article/jjasnaoe1903/

Suyama et al.: Preprint submitted to Elsevier

1955/77/1955_77_69/_pdf. (in Japanese).
Motora, S., 1959. On the measurement of added mass and added moment
of inertia for ship motions. Journal of Zosen Kiokai 1959, 83–92.
doi:10.2534/jjasnaoe1952.1959.83.
Nomoto, K., Taguchi, T., Honda, K., Hirano, S., 1957. On the steering
qualities of ships. International Shipbuilding Progress 4, 354–370.
Ogawa, A., Kasai, H., 1978. On the mathematical model of manoeuvring
motion of ships. International Shipbuilding Progress 25, 306–319.
doi:10.3233/ISP-1978-2529202.
Okuda, R., Yasukawa, H., Yamashita, T., Matsuda, A., 2023. Maneuvering
simulations at large drift angles of a ship with a flapped rudder. Applied
Ocean Research 135, 103567. doi:10.1016/J.APOR.2023.103567.
Oskin, D.A., Dyda, A.A., Markin, V.E., 2013. Neural network identification
of marine ship dynamics. IFAC Proceedings Volumes 46, 191–196.
doi:10.3182/20130918-4-JP-3022.00018.
Rajesh, G., Bhattacharyya, S.K., 2008. System identification for nonlinear
maneuvering of large tankers using artificial neural network. Applied
Ocean Research 30, 256–263. doi:10.1016/J.APOR.2008.10.003.
Ramirez, W.A., Leong, Z.Q., Nguyen, H., Jayasinghe, S.G., 2018. Nonparametric dynamic system identification of ships using multi-output
gaussian processes. Ocean Engineering 166, 26–36. doi:10.1016/J.
OCEANENG.2018.07.056.
Sakamoto, N., Akimoto, Y., 2017. Modified box constraint handling
for the covariance matrix adaptation evolution strategy, in: Genetic
and evolutionary computation conference, Association for Computing
Machinery (ACM). pp. 183–184. doi:10.1145/3067695.3075986.
Sakamoto, N., Ohashi, K., Araki, M., ichi Kume, K., Kobayashi, H., 2019.
Identification of kvlcc2 manoeuvring parameters for a modular-type
mathematical model by rans method with an overset approach. Ocean

Page 12 of 13

u [m/s]

Model-scale parameter
Tuned with ar = 0.2
Tuned with ar = 0.3
Tuned with ar = 0.4
Tuned with ar = 0.5
Tuned with ar = 0.6
Real-scale ship trial

nP [rpm]

Parameter fine-tuning method for MMG model using real-scale ship data

2
1
200

300

0

100

0

100

200

300

200

300

50

0.50

δ [deg. ]

vm [m/s]

x E [m]

100

0.25

200

0.75

25
0
25

1.00

0

50
0

0

100

100

0

100

200

300

50

t [s]
0

100

200

300

1.0

r [deg. /s]

y E [m]

0.8
0.6
0

100

200

300

t [s]
Fig. 11: Comparison of seven time series data of turning test (𝛿 = +40 deg.) which is not utilized in parameter tuning: real-scale
ship trial 𝐷+40 , simulation by the MMG model with untuned parameters, and simulation by the MMG model with tuned parameters
(𝑎r = 0.2 ∼ 0.6).

Engineering 188, 106257. doi:10.1016/J.OCEANENG.2019.106257.
Sutulo, S., Soares, C.G., 2014. An algorithm for offline identification of
ship manoeuvring mathematical models from free-running tests. Ocean
Engineering 79, 10–25. doi:10.1016/j.oceaneng.2014.01.007.
Sutulo, S., Soares, C.G., 2023. Application of an offline identification algorithm for adjusting parameters of a modular manoeuvring mathematical
model. Ocean Engineering 279, 114328. doi:10.1016/J.OCEANENG.2023.
114328.
Suyama, R., Miyauchi, Y., Maki, A., 2022. Ship trajectory planning method
for reproducing human operation at ports. Ocean Engineering 266,
112763. URL: https://doi.org/10.1016/j.oceaneng.2022.112763.
Wakita, K., Maki, A., Umeda, N., Miyauchi, Y., Shimoji, T., Rachman,
D.M., Akimoto, Y., 2022. On neural network identification for low-speed
ship maneuvering model. Journal of Marine Science and Technology 27,
772–785. doi:10.1007/s00773-021-00867-1.
Wang, Z., Kim, J., Im, N., 2023. Non-parameterized ship maneuvering
model of deep neural networks based on real voyage data-driven. Ocean
Engineering 284, 115162. doi:10.1016/J.OCEANENG.2023.115162.
Wang, Z., Xu, H., Xia, L., Zou, Z., Soares, C.G., 2020. Kernel-based support vector regression for nonparametric modeling of ship maneuvering
motion. Ocean Engineering 216, 107994. doi:10.1016/J.OCEANENG.2020.
107994.
Woo, J., Park, J., Yu, C., Kim, N., 2018. Dynamic model identification of
unmanned surface vehicles using deep learning network. Applied Ocean
Research 78, 123–133. doi:10.1016/J.APOR.2018.06.011.
Xue, Y., Liu, Y., Ji, C., Xue, G., Huang, S., 2020. System identification
of ship dynamic model based on gaussian process regression with input
noise. Ocean Engineering 216, 107862. doi:10.1016/J.OCEANENG.2020.
107862.

Suyama et al.: Preprint submitted to Elsevier

Yasukawa, H., Yoshimura, Y., 2015. Introduction of mmg standard method
for ship maneuvering predictions. J Mar Sci Technol 20, 37–52. doi:10.
1007/s00773-014-0293-y.
Yoon, H.K., Rhee, K.P., 2003. Identification of hydrodynamic coefficients in ship maneuvering equations of motion by estimation-beforemodeling technique. Ocean Engineering 30, 2379–2404. doi:10.1016/
S0029-8018(03)00106-9.
Zhang, C., Liu, X., Wan, D., Wang, J., 2019. Experimental and numerical
investigations of advancing speed effects on hydrodynamic derivatives
in mmg model, part i: Xvv,yv,nv. Ocean Engineering 179, 67–75.
doi:10.1016/j.oceaneng.2019.03.019.
Zhang, Q., ku Zhang, X., kyun Im, N., 2017. Ship nonlinear-feedback
course keeping algorithm based on mmg model driven by bipolar sigmoid function for berthing. International Journal of Naval Architecture
and Ocean Engineering 9, 525–536. doi:10.1016/J.IJNAOE.2017.01.004.
Zhang, X.G., Zou, Z.J., 2013. Black-box modeling of ship manoeuvring
motion based on feed-forward neural network with chebyshev orthogonal basis function. Journal of Marine Science and Technology 18, 42–49.
doi:10.1007/S00773-012-0190-1/FIGURES/5.
Zheng, Y., Tao, J., Sun, Q., Sun, H., Chen, Z., Sun, M., Xie, G., 2022. Soft
actor–critic based active disturbance rejection path following control for
unmanned surface vessel under wind and wave disturbances. Ocean
Engineering 247, 110631. doi:10.1016/J.OCEANENG.2022.110631.
Åström, K.J., Källström, C.G., 1976. Identification of ship steering dynamics. Automatica 12, 9–22. doi:10.1016/0005-1098(76)90064-9.

Page 13 of 13

